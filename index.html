<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Vote - Ta communaut√© fait ta force</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
     <link rel="icon" type="image/png" href="/assets/images/favicon.png">
    <style>
        /* ============================================
           SOCIAL VOTE - STYLES CSS INT√âGR√âS
           ============================================ */
        
        :root {
            --primary: #0A1F44;
            --accent: #D4AF37;
            --white: #FFFFFF;
            --light-bg: #F8F9FA;
            --gray: #6C757D;
            --dark-gray: #343A40;
            --success: #28A745;
            --danger: #DC3545;
            --shadow: 0 4px 15px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 30px rgba(0,0,0,0.15);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: var(--white);
            color: var(--dark-gray);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* ========== NAVBAR ========== */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: var(--primary);
            padding: 10px 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }
        
        .navbar.scrolled {
            padding: 10px 5%;
            box-shadow: var(--shadow);
        }
        
        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }
        
        .navbar-brand img {
            height: 45px;
        }
        
        .navbar-brand span {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
        }
        
        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }
        
        .nav-links a {
            color: var(--white);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            position: relative;
        }
        
        .nav-links a:hover {
            color: var(--accent);
        }
        
        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent);
            transition: var(--transition);
        }
        
        .nav-links a:hover::after {
            width: 100%;
        }
        
        .nav-auth {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: 600;
            text-decoration: none;
            transition: var(--transition);
            cursor: pointer;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--accent);
            color: var(--accent);
        }
        
        .btn-outline:hover {
            background: var(--accent);
            color: var(--primary);
        }
        
        .btn-primary {
            background: var(--accent);
            color: var(--primary);
        }
        
        .btn-primary:hover {
            background: #C4A030;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .btn-lg {
            padding: 15px 40px;
            font-size: 1.1rem;
        }
        
        .menu-toggle {
            display: none;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
        }
        
        .menu-toggle span {
            width: 25px;
            height: 3px;
            background: var(--white);
            transition: var(--transition);
        }
        
        /* ========== HERO SECTION ========== */
        .hero {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary) 0%, #1a3a6e 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 120px 5% 80px;
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="none" stroke="%23D4AF37" stroke-width="0.5" opacity="0.1"/></svg>') repeat;
            animation: float 20s infinite linear;
        }
        
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }
        
        .hero-content {
            text-align: center;
            position: relative;
            z-index: 1;
            max-width: 800px;
        }
        
        .hero h1 {
            font-size: 3.5rem;
            color: var(--white);
            margin-bottom: 20px;
            animation: fadeInUp 1s ease;
        }
        
        .hero h1 span {
            color: var(--accent);
        }
        
        .hero p {
            font-size: 1.3rem;
            color: rgba(255,255,255,0.8);
            margin-bottom: 40px;
            animation: fadeInUp 1s ease 0.2s both;
        }
        
        .hero-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            animation: fadeInUp 1s ease 0.4s both;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Timer Section */
        .timer-section {
            margin-top: 60px;
            animation: fadeInUp 1s ease 0.6s both;
        }
        
        .timer-label {
            color: var(--accent);
            font-size: 1.1rem;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .timer {
            display: flex;
            gap: 20px;
            justify-content: center;
        }
        
        .timer-box {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 20px 25px;
            border-radius: 15px;
            min-width: 90px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .timer-box .number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--white);
            display: block;
        }
        
        .timer-box .label {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
            text-transform: uppercase;
        }
        
        /* ========== GAME ACTIVE SECTION ========== */
        .section {
            padding: 80px 5%;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .section-title h2 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .section-title p {
            color: var(--gray);
            font-size: 1.1rem;
        }
        
        .section-title h2 span {
            color: var(--accent);
        }
        
        /* Game Status Cards */
        .game-status-card {
            background: var(--white);
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .game-header {
            background: var(--primary);
            color: var(--white);
            padding: 30px;
            text-align: center;
        }
        
        .game-header h3 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }
        
        .game-status-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .status-active {
            background: var(--success);
            color: var(--white);
        }
        
        .status-pending {
            background: var(--accent);
            color: var(--primary);
        }
        
        .status-ended {
            background: var(--danger);
            color: var(--white);
        }
        
        .game-body {
            padding: 40px;
        }
        
        .game-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .info-item {
            text-align: center;
        }
        
        .info-item i {
            font-size: 2rem;
            color: var(--accent);
            margin-bottom: 10px;
        }
        
        .info-item h4 {
            font-size: 1.5rem;
            color: var(--primary);
        }
        
        .info-item p {
            color: var(--gray);
        }
        
        /* Prizes Section */
        .prizes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .prize-card {
            background: linear-gradient(135deg, var(--primary) 0%, #1a3a6e 100%);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            color: var(--white);
            position: relative;
            overflow: hidden;
            transition: var(--transition);
        }
        
        .prize-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-lg);
        }
        
        .prize-card.gold {
            border: 3px solid #FFD700;
        }
        
        .prize-card.silver {
            border: 3px solid #C0C0C0;
        }
        
        .prize-card.bronze {
            border: 3px solid #CD7F32;
        }
        
        .prize-position {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }
        
        .gold .prize-position {
            background: #FFD700;
            color: var(--primary);
        }
        
        .silver .prize-position {
            background: #C0C0C0;
            color: var(--primary);
        }
        
        .bronze .prize-position {
            background: #CD7F32;
            color: var(--white);
        }
        
        .prize-image {
            width: 150px;
            height: 150px;
            border-radius: 15px;
            object-fit: cover;
            margin-bottom: 20px;
            border: 3px solid rgba(255,255,255,0.3);
        }
        
        .prize-card h4 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--accent);
        }
        
        .prize-card p {
            opacity: 0.9;
            font-size: 0.95rem;
        }
        
        /* Top 3 Podium */
        .podium-section {
            background: var(--light-bg);
        }
        
        .podium {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .podium-place {
            text-align: center;
            transition: var(--transition);
        }
        
        .podium-place:hover {
            transform: translateY(-10px);
        }
        
        .podium-place.first {
            order: 2;
        }
        
        .podium-place.second {
            order: 1;
        }
        
        .podium-place.third {
            order: 3;
        }
        
        .candidate-photo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--accent);
            margin-bottom: 15px;
        }
        
        .first .candidate-photo {
            width: 130px;
            height: 130px;
            border-color: #FFD700;
        }
        
        .podium-stand {
            padding: 20px 40px;
            border-radius: 10px 10px 0 0;
            color: var(--white);
            font-weight: 700;
        }
        
        .first .podium-stand {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            padding: 40px 50px;
        }
        
        .second .podium-stand {
            background: linear-gradient(135deg, #C0C0C0, #A0A0A0);
            padding: 30px 40px;
        }
        
        .third .podium-stand {
            background: linear-gradient(135deg, #CD7F32, #8B4513);
            padding: 25px 40px;
        }
        
        .candidate-name {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .candidate-votes {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        /* ========== HOW IT WORKS ========== */
        .how-it-works {
            background: var(--white);
        }
        
        .steps {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .step {
            text-align: center;
            padding: 30px;
            position: relative;
        }
        
        .step::after {
            content: '';
            position: absolute;
            top: 60px;
            right: -15px;
            width: 30px;
            height: 3px;
            background: var(--accent);
        }
        
        .step:last-child::after {
            display: none;
        }
        
        .step-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary), #1a3a6e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            position: relative;
        }
        
        .step-icon i {
            font-size: 2.5rem;
            color: var(--accent);
        }
        
        .step-number {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 35px;
            height: 35px;
            background: var(--accent);
            color: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }
        
        .step h4 {
            font-size: 1.2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .step p {
            color: var(--gray);
            font-size: 0.95rem;
        }
        
        /* ========== REFERRAL SECTION ========== */
        .referral-section {
            background: linear-gradient(135deg, var(--primary), #1a3a6e);
            color: var(--white);
        }
        
        .referral-section .section-title h2 {
            color: var(--white);
        }
        
        .referral-section .section-title p {
            color: rgba(255,255,255,0.8);
        }
        
        .referral-benefits {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 900px;
            margin: 0 auto;
        }
        
        .benefit-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(212, 175, 55, 0.3);
            transition: var(--transition);
        }
        
        .benefit-card:hover {
            transform: translateY(-5px);
            background: rgba(255,255,255,0.15);
        }
        
        .benefit-card i {
            font-size: 3rem;
            color: var(--accent);
            margin-bottom: 15px;
        }
        
        .benefit-card h4 {
            font-size: 1.8rem;
            color: var(--accent);
            margin-bottom: 10px;
        }
        
        .benefit-card p {
            opacity: 0.9;
        }
        
        /* ========== TESTIMONIALS ========== */
        /* ========== TESTIMONIALS (RESPONSIVE FIX) ========== */
            .testimonials {
                background: var(--light-bg);
                padding: 60px 0; /* Padding vertical seulement */
                overflow: hidden; /* Coupe ce qui d√©passe proprement */
            }

            .testimonials-slider {
                max-width: 1000px;
                width: 90%; /* Prend 90% de la largeur dispo, laisse une marge */
                margin: 0 auto;
                position: relative;
                overflow: hidden; /* Important pour le slider */
            }

            .testimonials-track {
                display: flex;
                transition: transform 0.5s ease;
                width: 100%; /* S'assure que le conteneur ne s'√©tire pas */
            }

            .testimonial-card {
                min-width: 100%; /* Prend toute la largeur du slider */
                box-sizing: border-box; /* Inclut le padding dans la largeur */
                padding: 40px 20px; /* Padding ajust√© pour mobile */
                background: var(--white);
                border-radius: 20px;
                box-shadow: var(--shadow);
                /* Pas de margin lat√©ral ici, sinon √ßa d√©cale le 100% */
                text-align: center;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .testimonial-photo {
                width: 100px;
                height: 100px;
                border-radius: 50%;
                object-fit: cover;
                margin-bottom: 20px;
                border: 4px solid var(--accent);
            }

            .testimonial-quote {
                font-size: 1.1rem;
                color: var(--dark-gray);
                font-style: italic;
                margin-bottom: 20px;
                line-height: 1.6;
                max-width: 800px; /* Limite la largeur du texte pour la lecture */
            }

            .testimonial-quote::before {
                content: '"';
                font-size: 3rem;
                color: var(--accent);
                display: block;
                line-height: 1;
                margin-bottom: -10px;
            }

            .testimonial-name {
                font-weight: 600;
                color: var(--primary);
                font-size: 1.1rem;
            }

            .testimonial-result {
                color: var(--accent);
                font-size: 0.9rem;
                margin-top: 5px;
            }

            /* Navigation */
            .slider-nav {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin-top: 30px;
            }

            .slider-btn {
                width: 45px;
                height: 45px;
                border-radius: 50%;
                border: 2px solid var(--primary);
                background: transparent;
                color: var(--primary);
                cursor: pointer;
                transition: var(--transition);
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .slider-btn:hover {
                background: var(--primary);
                color: var(--white);
            }

            /* Responsive sp√©cifique */
            @media (max-width: 576px) {
                .testimonial-quote {
                    font-size: 0.95rem; /* Texte un peu plus petit sur mobile */
                }
                .testimonial-card {
                    padding: 30px 15px;
                }
            }
        
        /* ========== ADVERTISEMENTS CAROUSEL ========== */
        .ads-section {
            background: var(--white);
            padding: 60px 0; /* Padding horizontal √† 0 pour laisser le carrousel toucher les bords si besoin */
            overflow: hidden;
            position: relative;
        }

        .ads-track {
            display: flex;
            gap: 30px; /* Espace entre les cartes */
            width: max-content; /* S'adapte au contenu total */
            /* Animation fluide : 30s pour un tour complet */
            animation: scrollInfinite 5s linear infinite;
            padding: 10px 0; /* Espace pour l'ombre */
        }

        .ads-track:hover {
            animation-play-state: paused;
        }

        @keyframes scrollInfinite {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); } 
            /* Va de 0 √† -50% (la moiti√© exacte, car le contenu est dupliqu√© par 2) */
        }

        /* Carte verticale */
        .ad-card {
            min-width: 350px;
            max-width: 350px;
            /* Pas de hauteur fixe, elle s'adaptera au contenu */
            background: var(--light-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            flex-shrink: 0;
            display: flex;
            flex-direction: column; /* Empile l'image puis le texte */
        }

        .ad-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        /* Image en Carr√© parfait 1:1 */
        .ad-image {
            width: 100%;
            height: 350px; /* M√™me hauteur que la largeur de la carte = Carr√© */
            object-fit: cover; /* Remplit le carr√© proprement */
            display: block; /* √âvite les petits espaces blancs fant√¥mes */
        }

        /* Contenu en dessous */
        .ad-content {
            padding: 20px;
            flex: 1; /* Prend le reste de l'espace si on fixait la hauteur de la carte */
            display: flex;
            flex-direction: column;
        }

        .ad-content h4 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .ad-content p {
            color: var(--gray);
            font-size: 0.95rem;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .ad-content .btn {
            width: 100%;
            margin-top: auto; /* Pousse le bouton tout en bas */
            justify-content: center;
        }
        
        /* ========== SPONSORS ========== */
        .sponsors-section {
            padding: 60px 5%;
            background: var(--light-bg);
        }
        
        .sponsors-track {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 50px;
            flex-wrap: wrap;
        }
        
        .sponsor-logo {
            height: 60px;
            filter: grayscale(100%);
            opacity: 0.7;
            transition: var(--transition);
        }
        
        .sponsor-logo:hover {
            filter: grayscale(0%);
            opacity: 1;
        }
        
        /* ========== STATS SECTION ========== */
        .stats-section {
            background: var(--primary);
            padding: 60px 5%;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .stat-item {
            text-align: center;
            color: var(--white);
        }
        
        .stat-number {
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent);
            display: block;
        }
        
        .stat-label {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        /* ========== FAQ ========== */
        .faq-section {
            background: var(--white);
        }
        
        .faq-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .faq-item {
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .faq-question {
            padding: 20px;
            background: var(--light-bg);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: var(--primary);
            transition: var(--transition);
        }
        
        .faq-question:hover {
            background: #e8e8e8;
        }
        
        .faq-question i {
            transition: var(--transition);
        }
        
        .faq-item.active .faq-question i {
            transform: rotate(180deg);
        }
        
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .faq-item.active .faq-answer {
            max-height: 300px;
        }
        
        .faq-answer p {
            padding: 20px;
            color: var(--gray);
        }
        
        /* ========== CTA SECTION ========== */
        .cta-section {
            background: linear-gradient(135deg, var(--accent), #C4A030);
            padding: 80px 5%;
            text-align: center;
        }
        
        .cta-section h2 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .cta-section p {
            color: var(--primary);
            opacity: 0.9;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }
        
        .cta-section .btn {
            background: var(--primary);
            color: var(--white);
        }
        
        .cta-section .btn:hover {
            background: #0d2a5c;
        }
        
        /* ========== FOOTER ========== */
        .footer {
            background: var(--primary);
            color: var(--white);
            padding: 30px 5% 15px;
        }
        
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto 40px;
        }
        
        .footer-col h4 {
            color: var(--accent);
            font-size: 1.2rem;
            margin-bottom: 20px;
        }
        
        .footer-col p {
            opacity: 0.8;
            line-height: 1.8;
        }
        
        .footer-col ul {
            list-style: none;
        }
        
        .footer-col ul li {
            margin-bottom: 10px;
        }
        
        .footer-col ul a {
            color: var(--white);
            opacity: 0.8;
            text-decoration: none;
            transition: var(--transition);
        }
        
        .footer-col ul a:hover {
            opacity: 1;
            color: var(--accent);
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-links a {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            transition: var(--transition);
        }
        
        .social-links a:hover {
            background: var(--accent);
            color: var(--primary);
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255,255,255,0.1);
            opacity: 0.7;
        }
        
        /* ========== POPUP ========== */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
        }
        
        .popup-overlay.active {
            display: flex;
        }
        
        .popup {
            background: var(--white);
            border-radius: 20px;
            max-width: 370px;
            width: 100%;
            overflow: hidden;
            animation: popupIn 0.3s ease;
        }
        
        @keyframes popupIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .popup-header {
            background: var(--primary);
            color: var(--white);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .popup-close {
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .popup-body {
            padding: 30px;
        }
        
        .popup-media {
            width: 100%;
            max-height: 370px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .popup-body h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .popup-body p {
            color: var(--gray);
            margin-bottom: 20px;
        }
        
        .popup-timer {
            text-align: center;
            color: var(--gray);
            margin-bottom: 15px;
        }
        
        /* ========== RESPONSIVE ========== */
        @media (max-width: 992px) {
            .nav-links {
                display: none;
            }
            
            .menu-toggle {
                display: flex;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .steps {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .step::after {
                display: none;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .timer {
                flex-wrap: wrap;
            }
            
            .timer-box {
                min-width: 70px;
                padding: 15px;
            }
            
            .timer-box .number {
                font-size: 1.8rem;
            }
            
            .steps {
                grid-template-columns: 1fr;
            }
            
            .podium {
                flex-direction: column;
                align-items: center;
            }
            
            .podium-place {
                order: unset !important;
            }
            
            .section-title h2 {
                font-size: 1.8rem;
            }
        }
        
        @media (max-width: 576px) {
            .hero-buttons {
                flex-direction: column;
            }
            
            .btn-lg {
                width: 100%;
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-auth {
                display: none;
            }
        }
        
        /* Mobile Menu */
        .mobile-menu {
            position: fixed;
            top: 0;
            left: -100%;
            width: 80%;
            max-width: 300px;
            height: 100vh;
            background: var(--primary);
            z-index: 1001;
            transition: var(--transition);
            padding: 15px 20px 30px;
        }
        
        .mobile-menu.active {
            left: 0;
        }
        
        .mobile-menu ul {
            list-style: none;
        }
        
        .mobile-menu ul li {
            margin-bottom: 3px;
        }
        
        .mobile-menu ul a {
            color: var(--white);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 700;
        }
        
        .mobile-menu-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .mobile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: none;
        }
        
        .mobile-overlay.active {
            display: block;
        }
        
        /* No game message */
        .no-game-message {
            text-align: center;
            padding: 60px 20px;
        }
        
        .no-game-message i {
            font-size: 3rem;
            color: var(--gray);
            margin-bottom: 2px;
        }
        
        .no-game-message h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .no-game-message p {
            color: var(--gray);
            margin-bottom: 20px;
        }
        
        /* Loading */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--light-bg);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .navbar-logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .navbar-logo img {
            height: 45px;
            width: auto;
        }

        @media (min-width: 768px) {
            .navbar-logo img {
                height: 40px;
            }
        }

        .navbar-logo span {
            font-size: 1.1rem;
            font-weight: 700;
            color: white;
        }

        @media (min-width: 768px) {
            .navbar-logo span {
                font-size: 1.35rem;
            }
        }

     .nav-links a {
        color: var(--white);
        text-decoration: none;
        font-weight: 500;
        transition: var(--transition);
        position: relative;            /* IMPORTANT pour la barre */
        padding: 6px 0;
        }

        /* Hover */
        .nav-links a:hover {
        color: var(--accent);
        }

        /* Barre sous le lien (page active) */
        .nav-links a.active::after {
        content: '';
        position: absolute;
        left: 0;
        bottom: -6px;
        width: 100%;
        height: 3px;
        background: var(--accent);
        border-radius: 3px;
        }

        /* Couleur du lien actif */
        .nav-links a.active {
        color: var(--accent);
        font-weight: 700;
        }

        /* Feedback clic (petit flash) */
        .nav-links a.clicked {
        opacity: 0.7;
        }

        .mobile-menu a {
        color: var(--white);
        text-decoration: none;
        font-size: 1rem;
        position: relative;
        padding: 6px 0;
        display: inline-block;
        }

        .mobile-menu a.active {
        color: var(--accent);
        font-weight: 700;
        }

        .mobile-menu a.active::after {
        content: '';
        position: absolute;
        left: 0;
        bottom: -6px;
        width: 100%;
        height: 3px;
        background: var(--accent);
        border-radius: 3px;
        }
     .nav-links a {
        color: var(--white);
        text-decoration: none;
        font-weight: 500;
        transition: var(--transition);
        position: relative;            /* IMPORTANT pour la barre */
        padding: 6px 0;
        }

        /* Hover */
        .nav-links a:hover {
        color: var(--accent);
        }

        /* Barre sous le lien (page active) */
        .nav-links a.active::after {
        content: '';
        position: absolute;
        left: 0;
        bottom: -6px;
        width: 100%;
        height: 3px;
        background: var(--accent);
        border-radius: 3px;
        }

        /* Couleur du lien actif */
        .nav-links a.active {
        color: var(--accent);
        font-weight: 700;
        }

        /* Feedback clic (petit flash) */
        .nav-links a.clicked {
        opacity: 0.7;
        }

        .mobile-menu a {
        color: var(--white);
        text-decoration: none;
        font-size: 1rem;
        position: relative;
        padding: 6px 0;
        display: inline-block;
        }

        .mobile-menu a.active {
        color: var(--accent);
        font-weight: 700;
        }

        .mobile-menu a.active::after {
        content: '';
        position: absolute;
        left: 0;
        bottom: -1px;
        width: 100%;
        height: 1px;
        background: var(--accent);
        border-radius: 3px;
        }

    /* =========================================================
   SOCIAL VOTE - GLOBAL RESPONSIVE PACK (ANDROID FIRST)
   Colle ce bloc √† la FIN du <style> de chaque page.
   Objectif: 0 overflow, navbar clean, forms clean, mobile menu ok.
   ========================================================= */

html, body { max-width: 100%; overflow-x: hidden; }
* { box-sizing: border-box; min-width: 0; }
img, video, canvas { max-width: 100%; height: auto; }

/* -------------------------
   NAVBAR: mobile behavior
   ------------------------- */

/* Emp√™che les √©l√©ments navbar de d√©border */
.navbar {
  max-width: 100%;
  gap: 12px;
}

/* Sur petit √©cran, on cache les boutons auth dans la navbar
   et on laisse le menu hamburger g√©rer l'auth */
@media (max-width: 576px) {
  .nav-auth { display: none !important; }
}

/* Si ton menu toggle n‚Äôappara√Æt pas partout, force-le sur mobile */
@media (max-width: 992px) {
  .menu-toggle { display: flex !important; }
  .nav-links { display: none !important; }
}

/* -------------------------
   BUTTONS: safe sizing
   ------------------------- */
.btn {
  max-width: 100%;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Sur mobile: boutons plus petits, mais restent sur 1 ligne quand possible */
@media (max-width: 576px) {
  .btn { padding: 10px 14px !important; border-radius: 14px !important; font-size: .95rem !important; }
  .btn-lg { padding: 12px 16px !important; font-size: 1rem !important; }
  .btn-sm { padding: 9px 12px !important; font-size: .85rem !important; }
}

/* Autoriser le retour √† la ligne uniquement sur les boutons "longs"
   => ajoute class="btn-wrap" sur les boutons qui ont du texte long */
.btn.btn-wrap { white-space: normal; line-height: 1.2; }

/* -------------------------
   LAYOUT: grids -> 1 col on mobile
   ------------------------- */

/* Beaucoup de tes pages utilisent .form-row => on force 1 colonne en mobile */
@media (max-width: 576px) {
  .form-row { grid-template-columns: 1fr !important; }
}

/* Tables: scroll horizontal */
.table-container,
.votes-table,
.referrals-table,
.candidates-table {
  width: 100%;
  overflow-x: auto;
}

/* -------------------------
   FORMS: no overflow
   ------------------------- */
input, select, textarea {
  width: 100%;
  max-width: 100%;
}

/* input-group: ne doit pas d√©passer */
.input-group { width: 100%; max-width: 100%; }

/* Referral input + bouton v√©rifier: stack sur mobile */
@media (max-width: 576px) {
  .referral-input-group { flex-direction: column !important; }
  .referral-input-group .btn { width: 100% !important; }
}

/* Auth: double boutons (login/register) => stack sur tr√®s petit √©cran */
@media (max-width: 420px) {
  .auth-two-buttons { grid-template-columns: 1fr !important; }
}

/* Modals: √©viter overflow */
.modal { max-width: 95vw !important; }
.modal-body { overflow-x: hidden; }

    </style>

<!-- ================= SEO & SOCIAL SHARING ================= -->
<meta property="og:title" content="Social Vote - Ta communaut√© fait ta force">
<meta property="og:description" content="Participez, votez pour vos candidats pr√©f√©r√©s et gagnez des prix exceptionnels !">
<meta property="og:image" content="https://placehold.co/1200x630?text=Social+Vote"> <!-- Remplace par une belle image h√©berg√©e sur Cloudinary -->
<meta property="og:url" content="https://ton-site.com">
<meta name="twitter:card" content="summary_large_image">

<!-- ================= LIBRAIRIES (CONFETTI + FINGERPRINT) ================= -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>
</head>
<body>
    <!-- ========== NAVBAR ========== -->
    <nav class="navbar" id="navbar">
        <a href="/" class="navbar-brand">
            <span class="navbar-logo"><img src="/assets/images/logo-white.png" alt="Social Vote" onerror="this.style.display='none'"></span>
        </a>
        
        <ul class="nav-links">
            <li><a href="/" class="active">Accueil</a></li>
            <li><a href="/vote/">Voter</a></li>
            <li><a href="/referral/">Parrainage</a></li>
            <li><a href="/history/">Historique</a></li>
            <li><a href="/sponsors/">Sponsors</a></li>
            <li><a href="/contact/">Contact</a></li>
        </ul>
        
        <div class="nav-auth" id="navAuth">
            <a href="/auth/" class="btn btn-outline">Connexion</a>
            <a href="/auth/?tab=register" class="btn btn-primary">S'inscrire</a>
        </div>
        
        <div class="menu-toggle" id="menuToggle">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </nav>
    
    <!-- Mobile Menu -->
    <div class="mobile-overlay" id="mobileOverlay"></div>
    <div class="mobile-menu" id="mobileMenu">
        <button class="mobile-menu-close" id="mobileMenuClose">
            <i class="fas fa-times"></i>
        </button>
        <ul>
            <li><a href="/">Accueil</a></li>
            <li><a href="/vote/">Voter</a></li>
            <li><a href="/referral/">Parrainage</a></li>
            <li><a href="/history/">Historique</a></li>
            <li><a href="/sponsors/">Sponsors</a></li>
            <li><a href="/contact/">Contact</a></li>
            <li><a href="/rules/">R√®glement</a></li>
            <li><a href="/auth/">Connexion</a></li>
            <li><a href="/auth/?tab=register">S'inscrire</a></li>
        </ul>
    </div>
    
    <!-- ========== HERO SECTION ========== -->
    <section class="hero">
        <div class="hero-content">
            <h1>Ta <span>communaut√©</span> fait ta <span>force</span></h1>
            <p>Participe aux comp√©titions de votes, mobilise ton r√©seau et remporte des prix exceptionnels !</p>
            
            <div class="hero-buttons">
                <a href="/auth/?tab=candidate" class="btn btn-primary btn-lg">
                    <i class="fas fa-user-plus"></i>
                    S'inscrire comme candidat
                </a>
                <a href="/vote/" class="btn btn-outline btn-lg">
                    <i class="fas fa-vote-yea"></i>
                    Voter maintenant
                </a>
            </div>
            
            <div class="timer-section" id="timerSection">
                <p class="timer-label" id="timerLabel">Chargement...</p>
                <div class="timer" id="timer">
                    <div class="timer-box">
                        <span class="number" id="days">00</span>
                        <span class="label">Jours</span>
                    </div>
                    <div class="timer-box">
                        <span class="number" id="hours">00</span>
                        <span class="label">Heures</span>
                    </div>
                    <div class="timer-box">
                        <span class="number" id="minutes">00</span>
                        <span class="label">Minutes</span>
                    </div>
                    <div class="timer-box">
                        <span class="number" id="seconds">00</span>
                        <span class="label">Secondes</span>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- ========== ACTIVE GAME SECTION ========== -->
    <section class="section" id="activeGameSection">
        <div class="section-title">
            <h2>üéÆ Jeu <span>Actuel</span></h2>
            <p>D√©couvrez le jeu en cours et ses r√©compenses</p>
        </div>
        
        <div id="gameContent">
            <div class="loading">
                <div class="spinner"></div>
            </div>
        </div>
    </section>
    
    <!-- ========== TOP 3 PODIUM ========== -->
    <section class="section podium-section" id="podiumSection" style="display: none;">
        <div class="section-title">
            <h2>üèÜ Top <span>3</span> Actuel</h2>
            <p>Les candidats en t√™te de la comp√©tition</p>
        </div>
        
        <div class="podium" id="podium">
            <!-- Dynamically populated -->
        </div>
        
        <div style="text-align: center; margin-top: 40px;">
            <a href="/vote/" class="btn btn-primary btn-lg">
                <i class="fas fa-users"></i>
                Voir tous les candidats
            </a>
        </div>
    </section>
    
    <!-- ========== HOW IT WORKS ========== -->
    <section class="section how-it-works">
        <div class="section-title">
            <h2>üìã Comment √ßa <span>marche</span> ?</h2>
            <p>Participez en 4 √©tapes simples</p>
        </div>
        
        <div class="steps">
            <div class="step">
                <div class="step-icon">
                    <i class="fas fa-user-plus"></i>
                    <span class="step-number">1</span>
                </div>
                <h4>Inscrivez-vous</h4>
                <p>Cr√©ez votre compte et inscrivez-vous comme candidat au jeu en cours</p>
            </div>
            
            <div class="step">
                <div class="step-icon">
                    <i class="fas fa-share-alt"></i>
                    <span class="step-number">2</span>
                </div>
                <h4>Partagez</h4>
                <p>Diffusez votre lien de vote aupr√®s de votre communaut√©</p>
            </div>
            
            <div class="step">
                <div class="step-icon">
                    <i class="fas fa-chart-line"></i>
                    <span class="step-number">3</span>
                </div>
                <h4>Collectez des votes</h4>
                <p>Recevez des votes gratuits et payants pour grimper dans le classement</p>
            </div>
            
            <div class="step">
                <div class="step-icon">
                    <i class="fas fa-trophy"></i>
                    <span class="step-number">4</span>
                </div>
                <h4>Gagnez</h4>
                <p>Remportez des prix exceptionnels si vous √™tes dans le top !</p>
            </div>
        </div>
    </section>
    
    <!-- ========== REFERRAL SECTION ========== -->
    <section class="section referral-section">
        <div class="section-title">
            <h2>ü§ù Programme de <span>Parrainage</span></h2>
            <p>Gagnez encore plus en parrainant d'autres candidats</p>
        </div>
        
        <div class="referral-benefits">
            <div class="benefit-card">
                <i class="fas fa-gift"></i>
                <h4>+15 votes</h4>
                <p>Pour chaque filleul que vous parrainez</p>
            </div>
            
            <div class="benefit-card">
                <i class="fas fa-user-friends"></i>
                <h4>+10 votes</h4>
                <p>Bonus pour votre filleul aussi</p>
            </div>
            
            <div class="benefit-card">
                <i class="fas fa-money-bill-wave"></i>
                <h4>1000 FCFA</h4>
                <p>√Ä partir de 10 filleuls<br>+500 FCFA par tranche de 5</p>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 40px;">
            <a href="/referral/" class="btn btn-primary btn-lg">
                <i class="fas fa-hand-holding-heart"></i>
                En savoir plus
            </a>
        </div>
    </section>
    
    <!-- ========== TESTIMONIALS ========== -->
    <section class="section testimonials">
        <div class="section-title">
            <h2>üí¨ T√©moignages de <span>Gagnants</span></h2>
            <p>Ils ont particip√© et ont gagn√©</p>
        </div>
        
        <div class="testimonials-slider" id="testimonialsSlider">
            <div class="testimonials-track" id="testimonialsTrack">
                <!-- Dynamically populated -->
            </div>
            
            <div class="slider-nav">
                <button class="slider-btn" id="prevBtn">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="slider-btn" id="nextBtn">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
            <div class="slider-dots" id="sliderDots">
                <!-- Dynamically populated -->
            </div>
        </div>
    </section>
    
    <!-- ========== ADVERTISEMENTS SECTION ========== -->
    <section class="ads-section" id="adsSection" style="display: none;">
        <div class="section-title">
            <h2>üì¢ <span>Actualit√©s</span></h2>
        </div>
        <div class="ads-track" id="adsTrack">
            <!-- Dynamically populated -->
        </div>
    </section>
    
    <!-- ========== SPONSORS ========== -->
    <section class="sponsors-section">
        <div class="section-title">
            <h2>ü§ù Nos <span>Partenaires</span></h2>
        </div>
        
        <div class="sponsors-track" id="sponsorsTrack">
            <!-- Dynamically populated -->
        </div>
    </section>
    
    <!-- ========== STATS ========== -->
    <section class="stats-section">
        <div class="stats-grid">
            <div class="stat-item">
                <span class="stat-number" id="statUsers">0</span>
                <span class="stat-label">Participants</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="statGames">0</span>
                <span class="stat-label">Jeux organis√©s</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="statVotes">0</span>
                <span class="stat-label">Votes enregistr√©s</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="statPrizes">0</span>
                <span class="stat-label">Prix distribu√©s</span>
            </div>
        </div>
    </section>
    
    <!-- ========== FAQ ========== -->
    <section class="section faq-section">
        <div class="section-title">
            <h2>‚ùì Questions <span>Fr√©quentes</span></h2>
        </div>
        
        <div class="faq-container">
            <div class="faq-item">
                <div class="faq-question">
                    <span>Comment participer √† un jeu ?</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Pour participer, cr√©ez d'abord un compte sur notre plateforme. Ensuite, inscrivez-vous comme candidat au jeu en cours en payant les frais d'inscription. Une fois votre candidature valid√©e par l'administration, vous appara√Ætrez sur la page de vote.</p>
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Comment fonctionne le vote ?</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Chaque visiteur peut voter gratuitement une fois par candidat. Des votes suppl√©mentaires peuvent √™tre achet√©s pour booster un candidat. Le candidat avec le plus de votes √† la fin du jeu remporte le premier prix.</p>
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Qu'est-ce que le programme de parrainage ?</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>En tant que candidat, vous recevez un code de parrainage unique. Chaque nouveau candidat qui s'inscrit avec votre code vous rapporte 15 votes bonus (et 10 votes pour lui). √Ä partir de 10 filleuls, vous recevez √©galement des r√©compenses en argent.</p>
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Comment recevoir mes gains ?</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Les gains sont envoy√©s via Mobile Money (MTN, Moov, Celtiis) sur le num√©ro que vous avez fourni lors de votre inscription. L'administration vous contactera via WhatsApp pour confirmer le paiement.</p>
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span>Quand puis-je voter ?</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="faq-answer">
                    <p>Vous pouvez voter uniquement pendant la p√©riode active du jeu. Les candidats sont visibles d√®s leur validation, mais les votes ne sont comptabilis√©s qu'apr√®s le d√©marrage officiel du jeu.</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- ========== CTA ========== -->
    <section class="cta-section">
        <h2>Pr√™t √† tenter ta chance ?</h2>
        <p>Rejoins des milliers de participants et remporte des prix exceptionnels</p>
        <a href="/auth/?tab=candidate" class="btn btn-lg">
            <i class="fas fa-rocket"></i>
            Commencer maintenant
        </a>
    </section>
    
    <!-- ========== FOOTER ========== -->
    <footer class="footer">
        <div class="footer-grid">
            <div class="footer-col">
                <h4>Social Vote</h4>
                <p>La plateforme de jeux communautaires o√π ta communaut√© fait ta force. Participe, vote et gagne !</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-whatsapp"></i></a>
                </div>
            </div>
            
            <div class="footer-col">
                <h4>Liens rapides</h4>
                <ul>
                    <li><a href="/">Accueil</a></li>
                    <li><a href="/vote/">Voter</a></li>
                    <li><a href="/referral/">Parrainage</a></li>
                    <li><a href="/history/">Historique</a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h4>Informations</h4>
                <ul>
                    <li><a href="/rules/">R√®glement</a></li>
                    <li><a href="/sponsors/">Sponsors</a></li>
                    <li><a href="/contact/">Contact</a></li>
                    <li><a href="#">Politique de confidentialit√©</a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h4>Contact</h4>
                <p><i class="fas fa-phone"></i> +229 01 90 08 62 67</p>
                <p><i class="fab fa-whatsapp"></i> +229 01 90 08 62 67</p>
                <p><i class="fas fa-envelope"></i> contact.socialvote@gmail.com</p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2026 Social Vote. Tous droits r√©serv√©s.</p>
        </div>
    </footer>
    
    <!-- ========== POPUP PUBLICITAIRE ========== -->
    <div class="popup-overlay" id="adPopup">
        <div class="popup">
            <div class="popup-header">
                <h4 id="popupTitle">Publicit√©</h4>
                <button class="popup-close" id="popupClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-body">
                <img src="" alt="" class="popup-media" id="popupMedia">
                <h3 id="popupHeading"></h3>
                <p id="popupDescription"></p>
                <a href="#" class="btn btn-primary" id="popupButton" style="width: 100%; justify-content: center;">
                    En savoir plus
                </a>
            </div>
        </div>
    </div>
    
    <!-- ========== SCRIPTS ========== -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        const CONFIG = {
            SUPABASE_URL: 'https://ynymnvmilertakacfrhy.supabase.co',
            SUPABASE_ANON_KEY: 'sb_publishable_jbmKmsT4FxmiTfYUBajgOA_QxWz8j2K',
            CLOUDINARY_CLOUD_NAME: 'drvkea88c',
            CLOUDINARY_UPLOAD_PRESET: 'social_vote_uploads'
        };
        
        // Initialisation Supabase
        const supabaseClient = supabase.createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_ANON_KEY);
        
        // ============================================
        // VARIABLES GLOBALES
        // ============================================
        let currentGame = null;
        let countdownInterval = null;
        let currentUser = null;
        let testimonialIndex = 0;
        let testimonials = [];
        
        // ============================================
        // INITIALISATION
        // ============================================
        document.addEventListener('DOMContentLoaded', async () => {
            setActiveNavLinks();
            initNavbar();
            initMobileMenu();
            initFAQ();
            // Cr√©er le bouton WhatsApp flottant
            createWhatsAppButton();
            await checkAuth();
            await loadActiveGame();
            await loadTestimonials();
            await loadSponsors();
            await loadGlobalStats();
            await loadAds();
            await showPopupAd();
        });
        
        // ============================================
        // AUTHENTIFICATION
        // ============================================
        async function checkAuth() {
            try {
                const session = localStorage.getItem('socialvote_session');
                if (session) {
                    currentUser = JSON.parse(session);
                    renderNavAuth();
                    updateNavAuth();
                }
            } catch (error) {
                console.error('Erreur auth:', error);
            }
        }
        
        function setActiveNavLinks() {
  // 1. R√©cup√©rer le chemin actuel (ex: "/" ou "/vote/" ou "/vote/index.html")
  const path = window.location.pathname;

  // 2. S√©lectionner tous les liens du menu (desktop et mobile)
  const links = document.querySelectorAll('.nav-links a, .mobile-menu a');

  links.forEach(a => {
    // R√©cup√©rer le lien cible
    const href = a.getAttribute('href');
    
    // On enl√®ve d'abord la classe active partout pour nettoyer
    a.classList.remove('active');

    // 3. Logique de comparaison intelligente
    if (path === '/' || path.endsWith('/index.html') && path.split('/').length <= 2) {
        // === CAS : PAGE D'ACCUEIL ===
        // On active si le lien pointe vers la racine ou index.html
        if (href === '/' || href === 'index.html' || href === './index.html' || href === '../index.html') {
            // V√©rification suppl√©mentaire : ne pas activer si le lien contient un sous-dossier
            if (!href.includes('/vote') && !href.includes('/history') && !href.includes('/referral')) {
                a.classList.add('active');
            }
        }
    } else {
        // === CAS : PAGES INTERNES (Dossiers) ===
        // On r√©cup√®re le nom du dossier actuel (ex: "vote" dans "/vote/")
        // path.split('/') donne ["", "vote", ""] => on prend l'index 1
        const currentFolder = path.split('/')[1]; 

        // Si le lien contient le nom du dossier actuel, c'est le bon !
        if (currentFolder && href.includes(currentFolder)) {
            a.classList.add('active');
        }
    }
  });
}

        function updateNavAuth() {
            const navAuth = document.getElementById('navAuth');
            if (currentUser) {
                navAuth.innerHTML = `
                    <a href="/profile/" class="btn btn-outline">
                        <i class="fas fa-user"></i>
                        ${currentUser.full_name.split(' ')[0]}
                    </a>
                    <button class="btn btn-primary" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                `;
            }
        }
        
        function logout() {
            localStorage.removeItem('socialvote_session');
            window.location.reload();
        }
        
        // ============================================
        // NAVBAR
        // ============================================
        function initNavbar() {
            const navbar = document.getElementById('navbar');
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) {
                    navbar.classList.add('scrolled');
                } else {
                    navbar.classList.remove('scrolled');
                }
            });
        }
        
        // ============================================
        // MOBILE MENU
        // ============================================
        function initMobileMenu() {
            const menuToggle = document.getElementById('menuToggle');
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileOverlay = document.getElementById('mobileOverlay');
            const mobileMenuClose = document.getElementById('mobileMenuClose');
            
            menuToggle.addEventListener('click', () => {
                mobileMenu.classList.add('active');
                mobileOverlay.classList.add('active');
            });
            
            const closeMenu = () => {
                mobileMenu.classList.remove('active');
                mobileOverlay.classList.remove('active');
            };
            
            mobileMenuClose.addEventListener('click', closeMenu);
            mobileOverlay.addEventListener('click', closeMenu);
        }
        
        // ============================================
        // CHARGEMENT DU JEU ACTIF
        // ============================================
        async function loadActiveGame() {
            try {
                // V√©rifier et mettre √† jour les statuts des jeux
                await updateGameStatuses();
                
                // Charger le jeu actif ou en attente
                const { data: games, error } = await supabaseClient
                    .from('games')
                    .select('*')
                    .in('status', ['active', 'pending'])
                    .order('start_time', { ascending: true })
                    .limit(1);
                
                if (error) throw error;
                
                const gameContent = document.getElementById('gameContent');
                
                if (games && games.length > 0) {
                    currentGame = games[0];
                    
                    // Charger les prix du jeu
                    const { data: prizes } = await supabaseClient
                        .from('game_prizes')
                        .select('*')
                        .eq('game_id', currentGame.id)
                        .order('position', { ascending: true });
                    
                    currentGame.prizes = prizes || [];
                    
                    displayGame(currentGame);
                    startCountdown();
                    
                    if (currentGame.status === 'active') {
                        await loadTop3();
                    }
                } else {
                    displayNoGame();
                }
            } catch (error) {
                console.error('Erreur chargement jeu:', error);
                displayNoGame();
            }
        }
        
        async function updateGameStatuses() {
            try {
                const now = new Date().toISOString();
                
                // D√©marrer les jeux dont l'heure est pass√©e
                await supabaseClient
                    .from('games')
                    .update({ status: 'active' })
                    .eq('status', 'pending')
                    .lte('start_time', now);
                
                // Terminer les jeux dont l'heure de fin est pass√©e
                await supabaseClient
                    .from('games')
                    .update({ status: 'ended' })
                    .eq('status', 'active')
                    .lte('end_time', now);
            } catch (error) {
                console.error('Erreur mise √† jour statuts:', error);
            }
        }
        
        function displayGame(game) {
            const gameContent = document.getElementById('gameContent');
            const statusClass = game.status === 'active' ? 'status-active' : 'status-pending';
            const statusText = game.status === 'active' ? 'üü¢ En cours' : 'üü° Inscriptions ouvertes';
            
            const startDate = new Date(game.start_time);
            const endDate = new Date(game.end_time);
            
            const formatDate = (date) => {
                return date.toLocaleDateString('fr-FR', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            };
            
            let prizesHTML = '';
            if (game.prizes && game.prizes.length > 0) {
                prizesHTML = `
                    <h4 style="text-align: center; margin-bottom: 20px; color: var(--primary);">
                        <i class="fas fa-trophy" style="color: var(--accent);"></i> Prix √† gagner
                    </h4>
                    <div class="prizes-grid">
                        ${game.prizes.map((prize, index) => {
                            const tierClass = index === 0 ? 'gold' : (index === 1 ? 'silver' : 'bronze');
                            return `
                                <div class="prize-card ${tierClass}">
                                    <span class="prize-position">${prize.position}</span>
                                    <img src="${prize.photo_url || 'https://placehold.co/150x150?text=Prix+' + prize.position}" 
                                         alt="${prize.title}" loading="lazy" class="prize-image">
                                    <h4>${prize.title}</h4>
                                    <p>${prize.description || ''}</p>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            }
            
            gameContent.innerHTML = `
                <div class="game-status-card">
                    <div class="game-header">
                        <h3>${game.title}</h3>
                        <p>${game.description || ''}</p>
                        <span class="game-status-badge ${statusClass}">${statusText}</span>
                    </div>
                    <div class="game-body">
                        <div class="game-info">
                            <div class="info-item">
                                <i class="fas fa-calendar-alt"></i>
                                <h4>D√©but</h4>
                                <p>${formatDate(startDate)}</p>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-calendar-check"></i>
                                <h4>Fin</h4>
                                <p>${formatDate(endDate)}</p>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-money-bill"></i>
                                <h4>Inscription</h4>
                                <p>${game.registration_fee} FCFA</p>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-vote-yea"></i>
                                <h4>Prix du vote</h4>
                                <p>${game.vote_price} FCFA</p>
                            </div>
                        </div>
                        
                        ${prizesHTML}
                        
                        <div style="text-align: center; margin-top: 30px;">
                            ${game.status === 'pending' ? `
                                <a href="/auth/?tab=candidate" class="btn btn-primary btn-lg">
                                    <i class="fas fa-user-plus"></i>
                                    S'inscrire maintenant
                                </a>
                            ` : `
                                <a href="/vote/" class="btn btn-primary btn-lg">
                                    <i class="fas fa-vote-yea"></i>
                                    Voter maintenant
                                </a>
                            `}
                        </div>
                    </div>
                </div>
            `;
            
            // Mettre √† jour le timer label
            const timerLabel = document.getElementById('timerLabel');
            if (game.status === 'active') {
                timerLabel.textContent = '‚è±Ô∏è Temps restant pour voter';
            } else {
                timerLabel.textContent = '‚è∞ Le jeu commence dans';
            }
        }
        
        function displayNoGame() {
            const gameContent = document.getElementById('gameContent');
            gameContent.innerHTML = `
                <div class="no-game-message">
                    <i class="fas fa-gamepad"></i>
                    <h3>Aucun jeu en cours</h3>
                    <p>Le prochain jeu sera bient√¥t annonc√©. Restez connect√© !</p>
                    <a href="/contact/" class="btn btn-primary">
                        <i class="fas fa-bell"></i>
                        Me notifier
                    </a>
                </div>
            `;
            loadLastArchivedGameSummary();
            document.getElementById('timerSection').style.display = 'none';
        }
        
        // ============================================
        // COUNTDOWN
        // ============================================
        function startCountdown() {
            if (countdownInterval) clearInterval(countdownInterval);
            
            const updateTimer = () => {
                if (!currentGame) return;
                
                const now = new Date().getTime();
                const targetDate = currentGame.status === 'active' 
                    ? new Date(currentGame.end_time).getTime()
                    : new Date(currentGame.start_time).getTime();
                
                const distance = targetDate - now;
                
                if (distance <= 0) {
                    // Le temps est √©coul√©, recharger la page pour mettre √† jour le statut
                    clearInterval(countdownInterval);
                    setTimeout(() => {
                        window.location.reload();
                    }, 1000);
                    return;
                }
                
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                
                document.getElementById('days').textContent = String(days).padStart(2, '0');
                document.getElementById('hours').textContent = String(hours).padStart(2, '0');
                document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
                document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
            };
            
            updateTimer();
            countdownInterval = setInterval(updateTimer, 1000);
        }
        
        // ============================================
        // TOP 3
        // ============================================
        async function loadTop3() {
        if (!currentGame || currentGame.status !== 'active') return;

        try {
            const { data: top3, error } = await supabaseClient
            .from('game_entries')
            .select(`
                id, total_votes, candidate_number,
                users:user_id (full_name, photo_url)
            `)
            .eq('game_id', currentGame.id)
            .eq('status', 'approved')
            .order('total_votes', { ascending: false })
            .limit(3);

            if (error) throw error;

            if (top3 && top3.length > 0) {
            displayTop3(top3);
            document.getElementById('podiumSection').style.display = 'block';
            }
        } catch (error) {
            console.error('Erreur chargement top 3:', error);
        }
        }
        
        function displayTop3(candidates) {
        const podium = document.getElementById('podium');
        const positions = ['first', 'second', 'third'];
        const medals = ['ü•á', 'ü•à', 'ü•â'];

        podium.innerHTML = candidates.map((candidate, index) => {
            const user = candidate.users || {};
            const photo = user.photo_url || `https://placehold.co/130x130?text=Photo`;

            return `
            <div class="podium-place ${positions[index]}">
                <img src="${photo}" alt="${user.full_name || 'Candidat'}" loading="lazy" class="candidate-photo"
                    onerror="this.src='https://placehold.co/130x130?text=Photo'">
                <p class="candidate-name">${user.full_name || 'Candidat'}</p>
                <p class="candidate-votes">${candidate.total_votes || 0} votes</p>
                <div class="podium-stand">
                <span style="font-size: 2rem;">${medals[index]}</span>
                </div>
            </div>
            `;
        }).join('');
        }
        
        // ============================================
        // TESTIMONIALS
        // ============================================
        async function loadTestimonials() {
            try {
                const { data, error } = await supabaseClient
                    .from('testimonials')
                    .select('*')
                    .eq('is_active', true)
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                testimonials = data || [];
                
                if (testimonials.length === 0) {
                    // Ajouter des t√©moignages par d√©faut pour la d√©mo
                    testimonials = [
                        {
                            name: 'Marie Dupont',
                            photo_url: 'https://randomuser.me/api/portraits/women/1.jpg',
                            quote: "Gr√¢ce √† Social Vote, j'ai pu remporter le premier prix du dernier jeu. Ma communaut√© m'a vraiment soutenue !",
                            game_title: 'Jeu de No√´l 2023',
                            rank_achieved: 1
                        },
                        {
                            name: 'Jean-Pierre Konan',
                            photo_url: 'https://randomuser.me/api/portraits/men/1.jpg',
                            quote: "Une exp√©rience incroyable ! Le programme de parrainage m'a permis de gagner des votes bonus et de l'argent.",
                            game_title: 'Challenge du Nouvel An',
                            rank_achieved: 2
                        },
                        {
                            name: 'Fatou Diallo',
                            photo_url: 'https://randomuser.me/api/portraits/women/2.jpg',
                            quote: "Je recommande Social Vote √† tous ceux qui veulent tester leur popularit√©. C'est fun et les prix sont r√©els !",
                            game_title: 'Comp√©tition de F√©vrier',
                            rank_achieved: 3
                        }
                    ];
                }
                
                displayTestimonials();
            } catch (error) {
                console.error('Erreur chargement t√©moignages:', error);
            }
        }
        
        function displayTestimonials() {
            const track = document.getElementById('testimonialsTrack');
            const dots = document.getElementById('sliderDots');
            
            track.innerHTML = testimonials.map(t => `
                <div class="testimonial-card">
                    <img src="${t.photo_url || 'https://placehold.co/100x100?text=Photo'}" 
                         alt="${t.name}" loading="lazy" class="testimonial-photo">
                    <p class="testimonial-quote">${t.quote}</p>
                    <p class="testimonial-name">${t.name}</p>
                    <p class="testimonial-result">
                        ${t.rank_achieved ? `üèÜ ${t.rank_achieved}${t.rank_achieved === 1 ? 'er' : '√®me'} - ` : ''}
                        ${t.game_title || ''}
                    </p>
                </div>
            `).join('');
            
            dots.innerHTML = testimonials.map((_, i) => `
                <span class="slider-dot ${i === 0 ? 'active' : ''}" data-index="${i}"></span>
            `).join('');
            
            // Event listeners pour navigation
            document.getElementById('prevBtn').addEventListener('click', () => slideTestimonial(-1));
            document.getElementById('nextBtn').addEventListener('click', () => slideTestimonial(1));
            
            dots.querySelectorAll('.slider-dot').forEach(dot => {
                dot.addEventListener('click', (e) => {
                    testimonialIndex = parseInt(e.target.dataset.index);
                    updateTestimonialSlider();
                });
            });
            
            // Auto-slide
            setInterval(() => slideTestimonial(1), 5000);
        }
        
        function slideTestimonial(direction) {
            testimonialIndex += direction;
            if (testimonialIndex < 0) testimonialIndex = testimonials.length - 1;
            if (testimonialIndex >= testimonials.length) testimonialIndex = 0;
            updateTestimonialSlider();
        }
        
        function updateTestimonialSlider() {
            const track = document.getElementById('testimonialsTrack');
            const dots = document.querySelectorAll('.slider-dot');
            
            track.style.transform = `translateX(-${testimonialIndex * 100}%)`;
            
            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === testimonialIndex);
            });
        }
        
        // ============================================
        // PUBLICIT√âS
        // ============================================
        async function loadAds() {
            try {
                const { data: ads, error } = await supabaseClient
                    .from('advertisements')
                    .select('*')
                    .eq('position', 'homepage_carousel')
                    .eq('is_active', true)
                    .order('display_order', { ascending: true });
                
                if (error) throw error;
                
                if (ads && ads.length > 0) {
                    displayAds(ads);
                }
            } catch (error) {
                console.error('Erreur chargement pubs:', error);
            }
        }
        
        function displayAds(ads) {
    const adsSection = document.getElementById('adsSection');
    const adsTrack = document.getElementById('adsTrack');
    
    if (!ads || ads.length === 0) {
        adsSection.style.display = 'none';
        return;
    }

    // 1. G√©n√©rer le HTML pour une seule s√©rie de pubs
    // Note: On ajoute data-ad-id et onclick pour pr√©parer le tracking de l'√©tape 3
    const singleSetHTML = ads.map(ad => `
         <div class="ad-card" data-ad-id="${ad.id}" onclick="AdTracker.trackClick('${ad.id}')">
             <img src="${ad.media_url || 'https://placehold.co/300x180?text=Publicit√©'}" 
                 alt="${ad.title}" loading="lazy" class="ad-image" 
                 style="width:100%; height:340px; object-fit:cover; border-radius:10px 10px 0 0;">
            <div class="ad-content" style="padding:15px;">
                <h4 style="margin:0 0 5px; color:var(--primary); font-size:1.1rem;">${ad.title}</h4>
                <p style="margin:0 0 10px; color:var(--gray); font-size:0.9rem; line-height:1.4;">${ad.description || ''}</p>
                ${ad.button_link ? `
                    <a href="${ad.button_link}" target="_blank" class="btn btn-primary btn-sm" style="width:100%;">
                        ${ad.button_text || 'En savoir plus'}
                    </a>
                ` : ''}
            </div>
        </div>
    `).join('');

    // 2. Injecter le HTML DEUX FOIS pour la boucle infinie
    // Set 1 + Set 2
    adsTrack.innerHTML = singleSetHTML + singleSetHTML;
    
    adsSection.style.display = 'block';
    setTimeout(() => AdTracker.init(), 1000); // Lancer l'observateur
    // (Pr√©paration √©tape 3 : On lancera le tracking ici plus tard)
    // setTimeout(initAdViewTracking, 1000); 
}
        
        async function showPopupAd() {
            // V√©rifier si l'utilisateur a d√©j√† vu le popup aujourd'hui
            const lastPopup = localStorage.getItem('socialvote_popup_date');
            const today = new Date().toDateString();
            
            if (lastPopup === today) return;
            
            try {
                const { data: ads, error } = await supabaseClient
                    .from('advertisements')
                    .select('*')
                    .eq('position', 'vote_popup')
                    .eq('is_active', true)
                    .limit(1);
                
                if (error) throw error;
                
                if (ads && ads.length > 0) {
                    const ad = ads[0];
                    displayPopupAd(ad);
                    localStorage.setItem('socialvote_popup_date', today);
                }
            } catch (error) {
                console.error('Erreur popup pub:', error);
            }
        }
        
        function displayPopupAd(ad) {
            const popup = document.getElementById('adPopup');
            const popupMedia = document.getElementById('popupMedia');
            const popupHeading = document.getElementById('popupHeading');
            const popupDescription = document.getElementById('popupDescription');
            const popupButton = document.getElementById('popupButton');
            const popupClose = document.getElementById('popupClose');
            
            popupMedia.src = ad.media_url || 'https://placehold.co/500x300?text=Publicit√©';
            popupHeading.textContent = ad.title;
            popupDescription.textContent = ad.description || '';
            
            if (ad.button_link) {
                popupButton.href = ad.button_link;
                popupButton.textContent = ad.button_text || 'En savoir plus';
                popupButton.style.display = 'block';
            } else {
                popupButton.style.display = 'none';
            }
            
            popup.classList.add('active');
            
            popupClose.addEventListener('click', () => {
                popup.classList.remove('active');
            });
            
            popup.addEventListener('click', (e) => {
                if (e.target === popup) {
                    popup.classList.remove('active');
                }
            });
            // AJOUT TRACKING : On ajoute l'ID pour l'IntersectionObserver
            popup.setAttribute('data-ad-id', ad.id);
            
            // AJOUT TRACKING : On tracke le clic sur le bouton
            const btn = document.getElementById('popupButton');
            btn.onclick = () => AdTracker.trackClick(ad.id);

            popup.classList.add('active');
            
            // On force le tracking de la vue imm√©diatement car c'est un popup
            AdTracker.trackView(ad.id);
            AdTracker.startWatchTimer(ad.id); // D√©marre le chrono
            
            // Arr√™ter le chrono √† la fermeture
            const closeBtn = document.getElementById('popupClose');
            closeBtn.addEventListener('click', () => {
                AdTracker.stopWatchTimer(ad.id);
            }, { once: true }); // Important: once pour ne pas empiler les events
        }
        
        // ============================================
        // SPONSORS
        // ============================================
        async function loadSponsors() {
            try {
                const { data: sponsors, error } = await supabaseClient
                    .from('sponsors')
                    .select('*')
                    .eq('is_active', true)
                    .order('display_order', { ascending: true });
                
                if (error) throw error;
                
                const track = document.getElementById('sponsorsTrack');
                
                if (sponsors && sponsors.length > 0) {
                    track.innerHTML = sponsors.map(s => `
                        <a href="${s.website_url || '#'}" target="_blank">
                            <img src="${s.logo_url || 'https://placehold.co/150x60?text=' + s.name}" 
                                 alt="${s.name}" loading="lazy" class="sponsor-logo">
                        </a>
                    `).join('');
                } else {
                    // Sponsors par d√©faut pour la d√©mo
                    track.innerHTML = `
                        <img src="https://placehold.co/150x60?text=Sponsor+1" class="sponsor-logo">
                        <img src="https://placehold.co/150x60?text=Sponsor+2" class="sponsor-logo">
                        <img src="https://placehold.co/150x60?text=Sponsor+3" class="sponsor-logo">
                        <img src="https://placehold.co/150x60?text=Sponsor+4" class="sponsor-logo">
                    `;
                }
            } catch (error) {
                console.error('Erreur chargement sponsors:', error);
            }
        }
        
        // ============================================
        // STATISTIQUES GLOBALES
        // ============================================
        async function loadGlobalStats() {
        try {
            // total users
            const { count: usersCount } = await supabaseClient
            .from('users')
            .select('*', { count: 'exact', head: true });

            // total games (cr√©√©s)
            const { count: gamesCount } = await supabaseClient
            .from('games')
            .select('*', { count: 'exact', head: true });

            // total votes (source de v√©rit√© = votes + bonus)
            const { data: votesRows } = await supabaseClient
            .from('votes')
            .select('vote_count');

            const votesFromTable = (votesRows || []).reduce((s, v) => s + (v.vote_count || 1), 0);

            const { data: bonusRows } = await supabaseClient
            .from('game_entries')
            .select('referral_bonus_votes');

            // const bonusVotes = (bonusRows || []).reduce((s, r) => s + (r.referral_bonus_votes || 0), 0);

            const totalVotes = votesFromTable;

            // prix distribu√©s = somme winners_count des jeux termin√©s/archiv√©s
            const { data: endedGames } = await supabaseClient
            .from('games')
            .select('winners_count')
            .in('status', ['ended', 'archived']);

            const totalPrizes = (endedGames || []).reduce((s, g) => s + (g.winners_count || 0), 0);

            animateCounter('statUsers', usersCount || 0);
            animateCounter('statGames', gamesCount || 0);
            animateCounter('statVotes', totalVotes || 0);
            animateCounter('statPrizes', totalPrizes || 0);
        } catch (error) {
            console.error('Erreur stats accueil:', error);
        }
        }
        
        function animateCounter(elementId, target) {
            const element = document.getElementById(elementId);
            const duration = 2000;
            const start = 0;
            const increment = target / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                element.textContent = Math.floor(current).toLocaleString();
            }, 16);
        }
        
        // ============================================
        // FAQ
        // ============================================
        function initFAQ() {
            const faqItems = document.querySelectorAll('.faq-item');
            
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                question.addEventListener('click', () => {
                    // Fermer les autres
                    faqItems.forEach(other => {
                        if (other !== item) other.classList.remove('active');
                    });
                    // Toggle celui-ci
                    item.classList.toggle('active');
                });
            });
        }

        async function loadLastArchivedGameSummary() {
  try {
    const { data: games } = await supabaseClient
      .from('games')
      .select('*')
      .in('status', ['archived', 'ended'])
      .order('end_time', { ascending: false })
      .limit(1);

    if (!games || games.length === 0) return;

    const lastGame = games[0];

    const { data: winners } = await supabaseClient
      .from('game_entries')
      .select('id, total_votes, users:user_id(full_name, photo_url)')
      .eq('game_id', lastGame.id)
      .eq('status', 'approved')
      .order('total_votes', { ascending: false })
      .limit(lastGame.winners_count || 3);

    const { data: awarded } = await supabaseClient
      .from('game_awarded_prizes')
      .select('*')
      .eq('game_id', lastGame.id)
      .order('position', { ascending: true });

    const { data: announced } = await supabaseClient
      .from('game_prizes')
      .select('*')
      .eq('game_id', lastGame.id)
      .order('position', { ascending: true });

    const prizes = (awarded && awarded.length) ? awarded : (announced || []);

    // inject block just under gameContent
    const gameContent = document.getElementById('gameContent');
    gameContent.innerHTML += `
      <div style="margin-top:25px;background:var(--light-bg);border-radius:20px;padding:25px;box-shadow:var(--shadow);">
        <h3 style="color:var(--primary);text-align:center;margin-bottom:10px;">üèÅ Dernier jeu termin√©</h3>
        <p style="text-align:center;color:var(--gray);margin-bottom:20px;"><strong>${lastGame.title}</strong></p>

        ${winners && winners.length ? `
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:15px;">
            ${winners.map((w, i) => {
              const p = prizes[i];
              const photo = (p?.photos && p.photos[0]) ? p.photos[0] : p?.photo_url;
              return `
                <div style="background:#fff;border-radius:16px;padding:15px;text-align:center;border:1px solid #eee;">
                  <div style="font-size:2rem;">${i===0?'ü•á':i===1?'ü•à':'ü•â'}</div>
                  <img src="${w.users?.photo_url || 'https://placehold.co/120x120?text=Photo'}" style="width:90px;height:90px;border-radius:50%;object-fit:cover;border:3px solid var(--accent);margin:10px auto;">
                  <div style="font-weight:800;color:var(--primary);">${w.users?.full_name || 'Gagnant'}</div>
                  <div style="color:var(--gray);font-size:.9rem;">${w.total_votes || 0} votes</div>
                  ${p ? `
                    <div style="margin-top:10px;color:var(--primary);font-weight:700;">${p.title}</div>
                    ${photo ? `<img src="${photo}" style="margin-top:8px;width:100%;max-height:430px;object-fit:cover;border-radius:12px;border:1px solid #ddd;">` : ''}
                  ` : ''}
                </div>
              `;
            }).join('')}
          </div>
        ` : `<p style="text-align:center;color:var(--gray);">Aucun gagnant disponible.</p>`}

        <div style="text-align:center;margin-top:20px;">
          <a href="/history/" class="btn btn-primary">
            <i class="fas fa-history"></i> Voir l'historique
          </a>
        </div>
      </div>
    `;
  } catch (e) {
    console.error('loadLastArchivedGameSummary error:', e);
  }
}

function renderNavAuth() {
  const navAuth = document.getElementById('navAuth');
  if (!navAuth) return;

  if (currentUser) {
    navAuth.innerHTML = `
      <a href="/auth/?tab=candidate" class="btn btn-primary btn-sm">
        <i class="fas fa-star"></i> S'inscrire comme candidat
      </a>
      <a href="/profile/" class="btn btn-outline btn-sm">
        <i class="fas fa-user"></i> ${currentUser.full_name.split(' ')[0]}
      </a>
      <button class="btn btn-outline btn-sm" onclick="logout()">
        <i class="fas fa-sign-out-alt"></i>
      </button>
    `;

    // Mobile menu: remplacer Connexion/Inscription par Profil/D√©connexion
    patchMobileMenuForLoggedIn();
  } else {
    navAuth.innerHTML = `
      <a href="/auth/" class="btn btn-outline btn-sm">Connexion</a>
      <a href="/auth/?tab=register" class="btn btn-primary btn-sm">S'inscrire</a>
    `;

    patchMobileMenuForLoggedOut();
  }
}

function patchMobileMenuForLoggedIn() {
  const menu = document.querySelector('.mobile-menu ul');
  if (!menu) return;

  // Enlever anciens liens si pr√©sents
  menu.querySelectorAll('[data-auth-link]').forEach(el => el.remove());

  // Ajouter Profil + D√©connexion (si pas d√©j√†)
  const liProfile = document.createElement('li');
  liProfile.setAttribute('data-auth-link', 'true');
  liProfile.innerHTML = `<a href="/profile/">Mon Profil</a>`;

  const liCandidate = document.createElement('li');
  liCandidate.setAttribute('data-auth-link', 'true');
  liCandidate.innerHTML = `<a href="/auth/?tab=candidate">S'inscrire comme candidat</a>`;

  const liLogout = document.createElement('li');
  liLogout.setAttribute('data-auth-link', 'true');
  liLogout.innerHTML = `<a href="#" onclick="logout(); return false;">D√©connexion</a>`;

  menu.appendChild(liCandidate);
  menu.appendChild(liProfile);
  menu.appendChild(liLogout);
}

function patchMobileMenuForLoggedOut() {
  const menu = document.querySelector('.mobile-menu ul');
  if (!menu) return;

  menu.querySelectorAll('[data-auth-link]').forEach(el => el.remove());

  const liLogin = document.createElement('li');
  liLogin.setAttribute('data-auth-link', 'true');
  liLogin.innerHTML = `<a href="/auth/">Connexion</a>`;

  const liRegister = document.createElement('li');
  liRegister.setAttribute('data-auth-link', 'true');
  liRegister.innerHTML = `<a href="/auth/?tab=register">S'inscrire</a>`;

  menu.appendChild(liLogin);
  menu.appendChild(liRegister);
}

// ==========================================
// BOUTON WHATSAPP FLOTTANT
// ==========================================

function createWhatsAppButton() {
  const whatsappBtn = document.createElement('a');
  whatsappBtn.href = 'https://wa.me/2290190086267';
  whatsappBtn.target = '_blank';
  whatsappBtn.className = 'whatsapp-float';
  whatsappBtn.innerHTML = `
    <img src="https://img.icons8.com/?size=100&id=85088&format=png&color=000000" alt="WhatsApp" style="width: 100%; height: 100%;">
  `;
  whatsappBtn.style.cssText = `
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 40px;
    height: 40px;
    background-color: #25D366;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    z-index: 9998;
    transition: all 0.3s ease;
    padding: 9px;
  `;
  
  whatsappBtn.addEventListener('mouseenter', () => {
    whatsappBtn.style.transform = 'scale(1.1)';
  });
  
  whatsappBtn.addEventListener('mouseleave', () => {
    whatsappBtn.style.transform = 'scale(1)';
  });
  
  document.body.appendChild(whatsappBtn);
}

// ============================================
// SYSTEME DE TRACKING PUBLICITAIRE
// ============================================

const AdTracker = {
    viewedAds: new Set(), // Pour ne pas compter 2 fois la m√™me vue dans la session
    watchTimers: {}, // Pour chronom√©trer le temps de vue

    // 1. Initialiser le tracking des vues (IntersectionObserver)
    init: function() {
        if (!('IntersectionObserver' in window)) return;

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                const adId = entry.target.dataset.adId;
                if (!adId) return;

                if (entry.isIntersecting) {
                    // La pub entre dans l'√©cran
                    this.trackView(adId);
                    this.startWatchTimer(adId);
                } else {
                    // La pub sort de l'√©cran
                    this.stopWatchTimer(adId);
                }
            });
        }, { threshold: 0.5 }); // Compte comme vu si 50% de la pub est visible

        // Observer toutes les pubs (carrousel et popups)
        document.querySelectorAll('[data-ad-id]').forEach(el => observer.observe(el));
    },

    // 2. Enregistrer une vue (Impression)
    trackView: async function(adId) {
        if (this.viewedAds.has(adId)) return; // D√©j√† vu cette session
        this.viewedAds.add(adId);

        console.log("Ad View:", adId);
        await this.sendEvent(adId, 'view');
    },

    // 3. Enregistrer un clic
    trackClick: async function(adId) {
        console.log("Ad Click:", adId);
        await this.sendEvent(adId, 'click');
    },

    // 4. Chronom√®tre (Watch Time)
    startWatchTimer: function(adId) {
        if (this.watchTimers[adId]) return; // D√©j√† en cours
        this.watchTimers[adId] = Date.now();
    },

    stopWatchTimer: async function(adId) {
        if (!this.watchTimers[adId]) return;
        
        const duration = Math.round((Date.now() - this.watchTimers[adId]) / 1000);
        delete this.watchTimers[adId];

        if (duration > 1) { // On ne compte pas les coups d'≈ìil < 1s
            console.log("Ad Watch Time:", adId, duration + "s");
            await this.sendEvent(adId, 'watch_time', duration);
        }
    },

    // 5. Envoi vers Supabase
    sendEvent: async function(adId, type, value = 1) {
        try {
            await supabaseClient.from('ad_events').insert([{
                ad_id: adId,
                event_type: type,
                event_value: value,
                // On peut ajouter visitor_id si connect√©
                visitor_id: currentUser ? currentUser.id : null,
                user_agent: navigator.userAgent
            }]);
        } catch (e) {
            console.warn("Tracking error:", e);
        }
    }
};

// Lancer le tracking quand le DOM est pr√™t (ou apr√®s chargement des pubs)
// document.addEventListener('DOMContentLoaded', () => setTimeout(AdTracker.init, 2000));
    </script>
</body>
</html>